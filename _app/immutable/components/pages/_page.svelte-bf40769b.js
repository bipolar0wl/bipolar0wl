import{S as Q,i as Z,s as x,k as b,q as L,l as y,m as k,r as N,h,n as d,b as S,G as m,I as ve,u as R,B as W,g as de,J as pe,K as be,d as he,f as A,t as P,o as ae,L as $,M as H,e as j,w as Y,x as K,y as z,N as G,z as X,a as U,c as q,O as ye,P as oe}from"../../chunks/index-981bc336.js";import{b as se,p as me,c as ke}from"../../chunks/store-69d22bd8.js";import{P as Ce}from"../../chunks/ProductList-4a1e70a6.js";function Ee(i){let e,t=i[1].name+"",s,a,o,r,n,l;return{c(){e=b("a"),s=L(t),this.h()},l(c){e=y(c,"A",{href:!0,"data-category-name":!0,class:!0});var g=k(e);s=N(g,t),g.forEach(h),this.h()},h(){d(e,"href",a="#"+i[1].name),d(e,"data-category-name",o=i[1].name),d(e,"class",r="category "+(i[0].id===i[1].id?"category--active":"")+" svelte-1c0y5ce")},m(c,g){S(c,e,g),m(e,s),n||(l=ve(e,"click",i[3]),n=!0)},p(c,[g]){g&2&&t!==(t=c[1].name+"")&&R(s,t),g&2&&a!==(a="#"+c[1].name)&&d(e,"href",a),g&2&&o!==(o=c[1].name)&&d(e,"data-category-name",o),g&3&&r!==(r="category "+(c[0].id===c[1].id?"category--active":"")+" svelte-1c0y5ce")&&d(e,"class",r)},i:W,o:W,d(c){c&&h(e),n=!1,l()}}}const ie=40;function we(i,e,t){let{category:s={id:0,name:""}}=e,{currentCategory:a={id:0,name:""}}=e;function o(){let n=document.getElementById(s.name);setTimeout(()=>{document.documentElement.clientHeight==document.body.scrollHeight-window.pageYOffset||window.pageYOffset+ie==n.offsetTop?(t(0,a=s),setTimeout(()=>{t(0,a=s)},100)):o()},100)}const r=n=>{n.preventDefault();let l=document.getElementById(s.name),c=l?l.offsetTop:0;window.scrollTo({top:c-ie,behavior:"smooth"}),o()};return i.$$set=n=>{"category"in n&&t(1,s=n.category),"currentCategory"in n&&t(0,a=n.currentCategory)},[a,s,o,r]}class Be extends Q{constructor(e){super(),Z(this,e,we,Ee,x,{category:1,currentCategory:0})}}function ce(i,e,t){const s=i.slice();return s[3]=e[t],s}function ue(i,e){let t,s,a,o;function r(l){e[2](l)}let n={category:e[3]};return e[0]!==void 0&&(n.currentCategory=e[0]),s=new Be({props:n}),$.push(()=>H(s,"currentCategory",r)),{key:i,first:null,c(){t=j(),Y(s.$$.fragment),this.h()},l(l){t=j(),K(s.$$.fragment,l),this.h()},h(){this.first=t},m(l,c){S(l,t,c),z(s,l,c),o=!0},p(l,c){e=l;const g={};c&2&&(g.category=e[3]),!a&&c&1&&(a=!0,g.currentCategory=e[0],G(()=>a=!1)),s.$set(g)},i(l){o||(A(s.$$.fragment,l),o=!0)},o(l){P(s.$$.fragment,l),o=!1},d(l){l&&h(t),X(s,l)}}}function Ie(i){let e,t=[],s=new Map,a,o=i[1];const r=n=>n[3].id;for(let n=0;n<o.length;n+=1){let l=ce(i,o,n),c=r(l);s.set(c,t[n]=ue(c,l))}return{c(){e=b("div");for(let n=0;n<t.length;n+=1)t[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var l=k(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(h),this.h()},h(){d(e,"class","categories svelte-xbh343")},m(n,l){S(n,e,l);for(let c=0;c<t.length;c+=1)t[c].m(e,null);a=!0},p(n,[l]){l&3&&(o=n[1],de(),t=pe(t,l,r,1,n,o,s,e,be,ue,null,ce),he())},i(n){if(!a){for(let l=0;l<o.length;l+=1)A(t[l]);a=!0}},o(n){for(let l=0;l<t.length;l+=1)P(t[l]);a=!1},d(n){n&&h(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function Te(i,e,t){let{categories:s=[]}=e,{currentCategory:a={id:0,name:""}}=e;ae(()=>{let r=document.getElementsByClassName("category");[].forEach.call(r,function(n,l,c){})});function o(r){a=r,t(0,a)}return i.$$set=r=>{"categories"in r&&t(1,s=r.categories),"currentCategory"in r&&t(0,a=r.currentCategory)},[a,s,o]}class Me extends Q{constructor(e){super(),Z(this,e,Te,Ie,x,{categories:1,currentCategory:0})}}function _e(i,e,t){const s=i.slice();return s[3]=e[t],s}function fe(i){let e,t,s,a,o,r,n,l,c=i[3].name+"",g,f,p=(i[0][i[3].id]||0)+"",u,E,_,v,T=i[3].description+"",B,V,M,D=i[3].price*i[0][i[3].id]+"",w,O;return{c(){e=b("div"),t=b("div"),s=b("img"),o=U(),r=b("div"),n=b("div"),l=b("span"),g=L(c),f=b("span"),u=L(p),E=L("x"),_=U(),v=b("span"),B=L(T),V=U(),M=b("div"),w=L(D),O=U(),this.h()},l(C){e=y(C,"DIV",{class:!0});var I=k(e);t=y(I,"DIV",{class:!0});var F=k(t);s=y(F,"IMG",{class:!0,src:!0,alt:!0}),o=q(F),r=y(F,"DIV",{class:!0});var J=k(r);n=y(J,"DIV",{class:!0});var ee=k(n);l=y(ee,"SPAN",{class:!0});var re=k(l);g=N(re,c),re.forEach(h),f=y(ee,"SPAN",{class:!0});var te=k(f);u=N(te,p),E=N(te,"x"),te.forEach(h),ee.forEach(h),_=q(J),v=y(J,"SPAN",{class:!0});var ne=k(v);B=N(ne,T),ne.forEach(h),J.forEach(h),F.forEach(h),V=q(I),M=y(I,"DIV",{class:!0});var le=k(M);w=N(le,D),le.forEach(h),O=q(I),I.forEach(h),this.h()},h(){d(s,"class","item__img svelte-11x6ndh"),oe(s.src,a="/bipolar0wl/"+i[3].image)||d(s,"src",a),d(s,"alt",""),d(l,"class","item__name svelte-11x6ndh"),d(f,"class","item__count svelte-11x6ndh"),d(n,"class","svelte-11x6ndh"),d(v,"class","item__description svelte-11x6ndh"),d(r,"class","item__text svelte-11x6ndh"),d(t,"class","item__info svelte-11x6ndh"),d(M,"class","item__price svelte-11x6ndh"),d(e,"class","item svelte-11x6ndh")},m(C,I){S(C,e,I),m(e,t),m(t,s),m(t,o),m(t,r),m(r,n),m(n,l),m(l,g),m(n,f),m(f,u),m(f,E),m(r,_),m(r,v),m(v,B),m(e,V),m(e,M),m(M,w),m(e,O)},p(C,I){I&2&&!oe(s.src,a="/bipolar0wl/"+C[3].image)&&d(s,"src",a),I&2&&c!==(c=C[3].name+"")&&R(g,c),I&3&&p!==(p=(C[0][C[3].id]||0)+"")&&R(u,p),I&2&&T!==(T=C[3].description+"")&&R(B,T),I&3&&D!==(D=C[3].price*C[0][C[3].id]+"")&&R(w,D)},d(C){C&&h(e)}}}function ge(i,e){let t,s,a=e[0][e[3].id]!=null&&fe(e);return{key:i,first:null,c(){t=j(),a&&a.c(),s=j(),this.h()},l(o){t=j(),a&&a.l(o),s=j(),this.h()},h(){this.first=t},m(o,r){S(o,t,r),a&&a.m(o,r),S(o,s,r)},p(o,r){e=o,e[0][e[3].id]!=null?a?a.p(e,r):(a=fe(e),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},d(o){o&&h(t),a&&a.d(o),o&&h(s)}}}function De(i){let e,t,s,a=[],o=new Map,r,n,l,c=i[1];const g=f=>f[3].id;for(let f=0;f<c.length;f+=1){let p=_e(i,c,f),u=g(p);o.set(u,a[f]=ge(u,p))}return{c(){e=b("div"),t=b("div"),s=b("div");for(let f=0;f<a.length;f+=1)a[f].c();r=U(),n=b("div"),l=b("textarea"),this.h()},l(f){e=y(f,"DIV",{class:!0});var p=k(e);t=y(p,"DIV",{class:!0});var u=k(t);s=y(u,"DIV",{class:!0});var E=k(s);for(let v=0;v<a.length;v+=1)a[v].l(E);E.forEach(h),u.forEach(h),r=q(p),n=y(p,"DIV",{class:!0});var _=k(n);l=y(_,"TEXTAREA",{class:!0,type:!0,placeholder:!0}),k(l).forEach(h),_.forEach(h),p.forEach(h),this.h()},h(){d(s,"class","basket__order__list svelte-11x6ndh"),d(t,"class","basket__order svelte-11x6ndh"),d(l,"class","basket__comment svelte-11x6ndh"),d(l,"type","text"),d(l,"placeholder","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439"),d(n,"class","svelte-11x6ndh"),d(e,"class","basket svelte-11x6ndh")},m(f,p){S(f,e,p),m(e,t),m(t,s);for(let u=0;u<a.length;u+=1)a[u].m(s,null);m(e,r),m(e,n),m(n,l)},p(f,[p]){p&3&&(c=f[1],a=pe(a,p,g,1,f,c,o,s,ye,ge,null,_e))},i:W,o:W,d(f){f&&h(e);for(let p=0;p<a.length;p+=1)a[p].d()}}}function Se(i,e,t){let{page:s=1}=e,a={};se.subscribe(r=>{t(0,a=r)});let o=[];return me.subscribe(r=>{t(1,o=r)}),ae(async()=>{let r=window.Telegram.WebApp;r.BackButton.show(),r.BackButton.onClick(()=>{r.MainButton.text="\u041F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0437\u0430\u043A\u0430\u0437",t(2,s=0),r.BackButton.hide()});for(var n=document.querySelectorAll(".basket__back a"),l=0;l<n.length;l++)n[l].addEventListener("click",function(){t(2,s=s==0?1:0)})}),i.$$set=r=>{"page"in r&&t(2,s=r.page)},[a,o,s]}class Ae extends Q{constructor(e){super(),Z(this,e,Se,De,x,{page:2})}}function Pe(i){let e,t,s;function a(r){i[9](r)}let o={};return i[4]!==void 0&&(o.page=i[4]),e=new Ae({props:o}),$.push(()=>H(e,"page",a)),{c(){Y(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,n){z(e,r,n),s=!0},p(r,n){const l={};!t&&n&16&&(t=!0,l.page=r[4],G(()=>t=!1)),e.$set(l)},i(r){s||(A(e.$$.fragment,r),s=!0)},o(r){P(e.$$.fragment,r),s=!1},d(r){X(e,r)}}}function Ve(i){let e,t,s,a,o,r,n,l;function c(_){i[5](_)}function g(_){i[6](_)}let f={};i[1]!==void 0&&(f.categories=i[1]),i[3]!==void 0&&(f.currentCategory=i[3]),e=new Me({props:f}),$.push(()=>H(e,"categories",c)),$.push(()=>H(e,"currentCategory",g));function p(_){i[7](_)}function u(_){i[8](_)}let E={products:i[2],categories:i[1]};return i[0]!==void 0&&(E.basket=i[0]),i[3]!==void 0&&(E.currentCategory=i[3]),o=new Ce({props:E}),$.push(()=>H(o,"basket",p)),$.push(()=>H(o,"currentCategory",u)),{c(){Y(e.$$.fragment),a=U(),Y(o.$$.fragment)},l(_){K(e.$$.fragment,_),a=q(_),K(o.$$.fragment,_)},m(_,v){z(e,_,v),S(_,a,v),z(o,_,v),l=!0},p(_,v){const T={};!t&&v&2&&(t=!0,T.categories=_[1],G(()=>t=!1)),!s&&v&8&&(s=!0,T.currentCategory=_[3],G(()=>s=!1)),e.$set(T);const B={};v&4&&(B.products=_[2]),v&2&&(B.categories=_[1]),!r&&v&1&&(r=!0,B.basket=_[0],G(()=>r=!1)),!n&&v&8&&(n=!0,B.currentCategory=_[3],G(()=>n=!1)),o.$set(B)},i(_){l||(A(e.$$.fragment,_),A(o.$$.fragment,_),l=!0)},o(_){P(e.$$.fragment,_),P(o.$$.fragment,_),l=!1},d(_){X(e,_),_&&h(a),X(o,_)}}}function Oe(i){let e,t,s,a,o;const r=[Ve,Pe],n=[];function l(c,g){return c[4]==0?0:1}return s=l(i),a=n[s]=r[s](i),{c(){e=b("main"),t=b("div"),a.c(),this.h()},l(c){e=y(c,"MAIN",{class:!0});var g=k(e);t=y(g,"DIV",{class:!0});var f=k(t);a.l(f),f.forEach(h),g.forEach(h),this.h()},h(){d(t,"class","app svelte-plkv"),d(e,"class","svelte-plkv")},m(c,g){S(c,e,g),m(e,t),n[s].m(t,null),o=!0},p(c,[g]){let f=s;s=l(c),s===f?n[s].p(c,g):(de(),P(n[f],1,1,()=>{n[f]=null}),he(),a=n[s],a?a.p(c,g):(a=n[s]=r[s](c),a.c()),A(a,1),a.m(t,null))},i(c){o||(A(a),o=!0)},o(c){P(a),o=!1},d(c){c&&h(e),n[s].d()}}}function Le(i,e,t){let s=[],a=[],o={},r={},n=0;ke.subscribe(u=>{t(1,s=u)}),me.subscribe(u=>{t(2,a=u)}),ae(async()=>{let u=window.Telegram.WebApp;t(3,o=s[0]),u.expand(),u.MainButton.setText("\u041F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0437\u0430\u043A\u0430\u0437"),u.MainButton.setParams({color:"#31b545"}),u.setBackgroundColor("secondary_bg_color"),u.MainButton.onClick(async()=>{if(u.HapticFeedback.impactOccurred("light"),n==0){t(4,n=1);let E=u.MainButton.text=Object.keys(r).reduce((w,O)=>w+a.find(C=>C.id==O).price*r[O],0);u.MainButton.setText(`\u041A \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u044E ${E} \u20BD`);let _="https://api.telegram.org/bot",v="5675048598:AAGP5FEItKSHcUD0GW8Velp8atfYHw4CmCM",T="381764678:TEST:49567",B=`${_}${v}/createInvoiceLink`,V=[];Object.keys(r).forEach(w=>{V.push({label:a[w].name,amount:a[w].price*r[w]+"00"})});let M={title:"telelavka",description:"telelavka test",provider_token:T,payload:"telelavka",currency:"RUB",prices:JSON.stringify(V)};console.log(B+"?"+new URLSearchParams(M));let D=await fetch(B+"?"+new URLSearchParams(M),{method:"GET",headers:{"Content-Type":"application/json"}}).then(w=>w.text()).then(w=>u.openInvoice(JSON.parse(w).result));D.ok?await D.json():alert("\u041E\u0448\u0438\u0431\u043A\u0430 HTTP: "+D.status)}else u.MainButton.text="\u041F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0437\u0430\u043A\u0430\u0437"}),se.subscribe(E=>{t(0,r=E),Object.keys(r).length!==0?u.MainButton.show():u.MainButton.hide()})});function l(u){s=u,t(1,s)}function c(u){o=u,t(3,o)}function g(u){r=u,t(0,r)}function f(u){o=u,t(3,o)}function p(u){n=u,t(4,n)}return i.$$.update=()=>{i.$$.dirty&1&&se.set(r)},[r,s,a,o,n,l,c,g,f,p]}class je extends Q{constructor(e){super(),Z(this,e,Le,Oe,x,{})}}export{je as default};
