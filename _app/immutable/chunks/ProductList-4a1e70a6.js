import{S as U,i as F,s as H,k as m,l as v,m as y,h as g,n as k,b as C,B as J,o as ae,q as T,a as N,r as V,c as S,G as h,I as K,u as M,Q as de,L as Q,M as W,w as Y,x as j,P as te,y as R,N as X,f as q,t as A,z as Z,g as oe,J as ie,K as ue,d as fe,e as G}from"./index-981bc336.js";import{b as _e}from"./store-69d22bd8.js";function he(i){let e,t,l,r,n,o,c,s,a,d,u;return{c(){e=m("div"),t=m("button"),l=T("-"),r=N(),n=m("span"),o=T(i[0]),c=N(),s=m("button"),a=T("+"),this.h()},l(b){e=v(b,"DIV",{class:!0});var p=y(e);t=v(p,"BUTTON",{class:!0});var _=y(t);l=V(_,"-"),_.forEach(g),r=S(p),n=v(p,"SPAN",{class:!0});var f=y(n);o=V(f,i[0]),f.forEach(g),c=S(p),s=v(p,"BUTTON",{class:!0});var E=y(s);a=V(E,"+"),E.forEach(g),p.forEach(g),this.h()},h(){k(t,"class","decrement svelte-1ap7wl4"),k(n,"class","count svelte-1ap7wl4"),k(s,"class","increment svelte-1ap7wl4"),k(e,"class","counter-edit svelte-1ap7wl4")},m(b,p){C(b,e,p),h(e,t),h(t,l),h(e,r),h(e,n),h(n,o),h(e,c),h(e,s),h(s,a),d||(u=[K(t,"click",i[2]),K(s,"click",i[1])],d=!0)},p(b,p){p&1&&M(o,b[0])},d(b){b&&g(e),d=!1,de(u)}}}function ge(i){let e,t,l,r,n,o,c;return{c(){e=m("div"),t=m("button"),l=m("span"),r=T(i[3]),n=T(" \u20BD"),this.h()},l(s){e=v(s,"DIV",{class:!0});var a=y(e);t=v(a,"BUTTON",{class:!0});var d=y(t);l=v(d,"SPAN",{class:!0});var u=y(l);r=V(u,i[3]),n=V(u," \u20BD"),u.forEach(g),d.forEach(g),a.forEach(g),this.h()},h(){k(l,"class","svelte-1ap7wl4"),k(t,"class","add-button svelte-1ap7wl4"),k(e,"class","counter-new svelte-1ap7wl4")},m(s,a){C(s,e,a),h(e,t),h(t,l),h(l,r),h(l,n),o||(c=K(t,"click",i[1]),o=!0)},p:J,d(s){s&&g(e),o=!1,c()}}}function be(i){let e;function t(n,o){return n[0]==0?ge:he}let l=t(i),r=l(i);return{c(){e=m("div"),r.c(),this.h()},l(n){e=v(n,"DIV",{class:!0});var o=y(e);r.l(o),o.forEach(g),this.h()},h(){k(e,"class","counter svelte-1ap7wl4")},m(n,o){C(n,e,o),r.m(e,null)},p(n,[o]){l===(l=t(n))&&r?r.p(n,o):(r.d(1),r=l(n),r&&(r.c(),r.m(e,null)))},i:J,o:J,d(n){n&&g(e),r.d()}}}function pe(i,e,t){let{product:l={id:0,name:"",description:"",price:0}}=e,{basket:r={}}=e,n;ae(async()=>{n=window.Telegram.WebApp}),_e.subscribe(d=>{t(4,r=d)});let o=r[l.id]||0;const c=()=>{n.HapticFeedback.impactOccurred("light"),t(0,o+=1),t(4,r[l.id]=o,r)},s=()=>{n.HapticFeedback.impactOccurred("light"),t(0,o-=1),r[l.id]&&o<=0?(delete r[l.id],t(4,r)):t(4,r[l.id]=o,r)};let a=l.price.toString();return i.$$set=d=>{"product"in d&&t(5,l=d.product),"basket"in d&&t(4,r=d.basket)},[o,c,s,a,r,l]}class ke extends U{constructor(e){super(),F(this,e,pe,be,H,{product:5,basket:4})}}function se(i){let e,t;return{c(){e=m("button"),t=T("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C")},l(l){e=v(l,"BUTTON",{});var r=y(e);t=V(r,"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"),r.forEach(g)},m(l,r){C(l,e,r),h(e,t)},d(l){l&&g(e)}}}function me(i){let e,t,l,r,n,o,c,s=i[1].name+"",a,d,u,b=i[1].description+"",p,_,f,E,z,D;function O(w){i[3](w)}let x={product:i[1]};i[0]!==void 0&&(x.basket=i[0]),f=new ke({props:x}),Q.push(()=>W(f,"basket",O));let P=i[2].edit&&se();return{c(){e=m("div"),t=m("img"),r=N(),n=m("div"),o=m("div"),c=m("p"),a=T(s),d=N(),u=m("p"),p=T(b),_=N(),Y(f.$$.fragment),z=N(),P&&P.c(),this.h()},l(w){e=v(w,"DIV",{class:!0});var I=y(e);t=v(I,"IMG",{class:!0,src:!0,alt:!0}),r=S(I),n=v(I,"DIV",{class:!0});var B=y(n);o=v(B,"DIV",{});var L=y(o);c=v(L,"P",{class:!0});var $=y(c);a=V($,s),$.forEach(g),d=S(L),u=v(L,"P",{class:!0});var ee=y(u);p=V(ee,b),ee.forEach(g),L.forEach(g),_=S(B),j(f.$$.fragment,B),B.forEach(g),z=S(I),P&&P.l(I),I.forEach(g),this.h()},h(){k(t,"class","product__img svelte-ckzk61"),te(t.src,l="/bipolar0wl/"+i[1].image)||k(t,"src",l),k(t,"alt","Nothing here"),k(c,"class","product__name svelte-ckzk61"),k(u,"class","product__description svelte-ckzk61"),k(n,"class","product__info svelte-ckzk61"),k(e,"class","product svelte-ckzk61")},m(w,I){C(w,e,I),h(e,t),h(e,r),h(e,n),h(n,o),h(o,c),h(c,a),h(o,d),h(o,u),h(u,p),h(n,_),R(f,n,null),h(e,z),P&&P.m(e,null),D=!0},p(w,[I]){(!D||I&2&&!te(t.src,l="/bipolar0wl/"+w[1].image))&&k(t,"src",l),(!D||I&2)&&s!==(s=w[1].name+"")&&M(a,s),(!D||I&2)&&b!==(b=w[1].description+"")&&M(p,b);const B={};I&2&&(B.product=w[1]),!E&&I&1&&(E=!0,B.basket=w[0],X(()=>E=!1)),f.$set(B),w[2].edit?P||(P=se(),P.c(),P.m(e,null)):P&&(P.d(1),P=null)},i(w){D||(q(f.$$.fragment,w),D=!0)},o(w){A(f.$$.fragment,w),D=!1},d(w){w&&g(e),Z(f),P&&P.d()}}}function ve(i,e,t){let{product:l={id:0,name:"",description:"",price:0}}=e,{rules:r={edit:!1}}=e,{basket:n={}}=e;function o(c){n=c,t(0,n)}return i.$$set=c=>{"product"in c&&t(1,l=c.product),"rules"in c&&t(2,r=c.rules),"basket"in c&&t(0,n=c.basket)},[n,l,r,o]}class ye extends U{constructor(e){super(),F(this,e,ve,me,H,{product:1,rules:2,basket:0})}}function le(i,e,t){const l=i.slice();return l[5]=e[t],l}function re(i,e){let t,l,r,n;function o(s){e[4](s)}let c={product:e[5],rules:e[3]};return e[0]!==void 0&&(c.basket=e[0]),l=new ye({props:c}),Q.push(()=>W(l,"basket",o)),{key:i,first:null,c(){t=G(),Y(l.$$.fragment),this.h()},l(s){t=G(),j(l.$$.fragment,s),this.h()},h(){this.first=t},m(s,a){C(s,t,a),R(l,s,a),n=!0},p(s,a){e=s;const d={};a&4&&(d.product=e[5]),a&8&&(d.rules=e[3]),!r&&a&1&&(r=!0,d.basket=e[0],X(()=>r=!1)),l.$set(d)},i(s){n||(q(l.$$.fragment,s),n=!0)},o(s){A(l.$$.fragment,s),n=!1},d(s){s&&g(t),Z(l,s)}}}function we(i){let e,t,l,r=i[1].name+"",n,o,c,s=[],a=new Map,d,u,b=i[2];const p=_=>_[5].id;for(let _=0;_<b.length;_+=1){let f=le(i,b,_),E=p(f);a.set(E,s[_]=re(E,f))}return{c(){e=m("div"),t=m("div"),l=m("b"),n=T(r),o=N(),c=m("div");for(let _=0;_<s.length;_+=1)s[_].c();this.h()},l(_){e=v(_,"DIV",{class:!0,id:!0});var f=y(e);t=v(f,"DIV",{class:!0});var E=y(t);l=v(E,"B",{});var z=y(l);n=V(z,r),z.forEach(g),E.forEach(g),o=S(f),c=v(f,"DIV",{class:!0});var D=y(c);for(let O=0;O<s.length;O+=1)s[O].l(D);D.forEach(g),f.forEach(g),this.h()},h(){k(t,"class","product__group__category svelte-ancbr3"),k(c,"class","product__group__produtcs svelte-ancbr3"),k(e,"class","product__group svelte-ancbr3"),k(e,"id",d=i[1].name)},m(_,f){C(_,e,f),h(e,t),h(t,l),h(l,n),h(e,o),h(e,c);for(let E=0;E<s.length;E+=1)s[E].m(c,null);u=!0},p(_,[f]){(!u||f&2)&&r!==(r=_[1].name+"")&&M(n,r),f&13&&(b=_[2],oe(),s=ie(s,f,p,1,_,b,a,c,ue,re,null,le),fe()),(!u||f&2&&d!==(d=_[1].name))&&k(e,"id",d)},i(_){if(!u){for(let f=0;f<b.length;f+=1)q(s[f]);u=!0}},o(_){for(let f=0;f<s.length;f+=1)A(s[f]);u=!1},d(_){_&&g(e);for(let f=0;f<s.length;f+=1)s[f].d()}}}function Ee(i,e,t){let{category:l={id:0,name:""}}=e,{products:r=[{id:0,title:"",body:""}]}=e,{basket:n={}}=e,{rules:o={edit:!1}}=e;function c(s){n=s,t(0,n)}return i.$$set=s=>{"category"in s&&t(1,l=s.category),"products"in s&&t(2,r=s.products),"basket"in s&&t(0,n=s.basket),"rules"in s&&t(3,o=s.rules)},[n,l,r,o,c]}class Pe extends U{constructor(e){super(),F(this,e,Ee,we,H,{category:1,products:2,basket:0,rules:3})}}function ne(i,e,t){const l=i.slice();return l[8]=e[t],l}function ce(i,e){let t,l,r,n;function o(...a){return e[5](e[8],...a)}function c(a){e[6](a)}let s={category:e[8],products:e[3].filter(o),rules:e[1]};return e[0]!==void 0&&(s.basket=e[0]),l=new Pe({props:s}),Q.push(()=>W(l,"basket",c)),{key:i,first:null,c(){t=G(),Y(l.$$.fragment),this.h()},l(a){t=G(),j(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,d){C(a,t,d),R(l,a,d),n=!0},p(a,d){e=a;const u={};d&4&&(u.category=e[8]),d&12&&(u.products=e[3].filter(o)),d&2&&(u.rules=e[1]),!r&&d&1&&(r=!0,u.basket=e[0],X(()=>r=!1)),l.$set(u)},i(a){n||(q(l.$$.fragment,a),n=!0)},o(a){A(l.$$.fragment,a),n=!1},d(a){a&&g(t),Z(l,a)}}}function Ie(i){let e,t=[],l=new Map,r,n=i[2];const o=c=>c[8].id;for(let c=0;c<n.length;c+=1){let s=ne(i,n,c),a=o(s);l.set(a,t[c]=ce(a,s))}return{c(){e=m("div");for(let c=0;c<t.length;c+=1)t[c].c();this.h()},l(c){e=v(c,"DIV",{class:!0});var s=y(e);for(let a=0;a<t.length;a+=1)t[a].l(s);s.forEach(g),this.h()},h(){k(e,"class","products svelte-1iufgiz")},m(c,s){C(c,e,s);for(let a=0;a<t.length;a+=1)t[a].m(e,null);r=!0},p(c,[s]){s&15&&(n=c[2],oe(),t=ie(t,s,o,1,c,n,l,e,ue,ce,null,ne),fe())},i(c){if(!r){for(let s=0;s<n.length;s+=1)q(t[s]);r=!0}},o(c){for(let s=0;s<t.length;s+=1)A(t[s]);r=!1},d(c){c&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function De(i,e,t){let{rules:l={edit:!1}}=e,{basket:r={}}=e,{categories:n=[]}=e,{products:o=[]}=e,{currentCategory:c={id:0,name:""}}=e;ae(async()=>{document.querySelectorAll(".product__group").forEach(b=>{b.addEventListener("click",function(p){},!1)}),window.addEventListener("scroll",b=>{s()})});function s(u){let b=document.querySelectorAll(".product__group");for(let p=0;p<b.length;p++){let _=b[p];if(t(4,c=n[p]),window.pageYOffset<_.offsetTop)break}}const a=(u,b)=>b.category_id==u.id;function d(u){r=u,t(0,r)}return i.$$set=u=>{"rules"in u&&t(1,l=u.rules),"basket"in u&&t(0,r=u.basket),"categories"in u&&t(2,n=u.categories),"products"in u&&t(3,o=u.products),"currentCategory"in u&&t(4,c=u.currentCategory)},[r,l,n,o,c,a,d]}class Ce extends U{constructor(e){super(),F(this,e,De,Ie,H,{rules:1,basket:0,categories:2,products:3,currentCategory:4})}}export{Ce as P};
